# Техническое задание: Система авторизации и доступа к меню

## Описание системы

Взаимодействие:
```
Фронтенд <-> Бекенд (наш) <-> Бекенд (модуль авторизации)
Фронтенд <-> Бекенд (модуль авторизации)
- может быть и так для отладки и проверки авторизации и безопасности
```

При авторизации пользователя происходит генерация _токена_, который сохраняется:

- в базе данных
- клиента.

Этот токен используется для доступа к данным.

## 1. Авторизация

### Процесс авторизации

1. Пользователь вводит _логин_ и _пароль_.
2. На сервере(модуль авторизации) создается _токен_,
   который содержит информацию о пользователе.
3. _Токен_ возвращается клиенту и сохраняется для последующих запросов.

## 2. Доступ к меню

### Описание структуры меню

Каждый пункт меню содержит URL и права доступа 

(просмотр, редактирование, удаление).

Пример структуры меню:

```json
{
  "orders": {
    "URL": "/list?type=orders&group=tech_calc",
    "permissions": {
      "view": true,
      "edit": true,
      "delete": true
    }
  }
}
```

- type = orders
- group = tech_calc

### Пояснения:

- _orders_ - идентификатор пункта меню.

- _URL_ - адрес _API_ для получения списка данных,
  включающий параметр _group_, 
  который учитывает группу пользователя.

- _permissions_ - права доступа пользователя к пункту меню.

## 3. Запрос к API при открытии заказа

### Описание процесса

При открытии состава заказа происходит обращение к _API_, 

в котором передаются следующие параметры:

- _Токен_ — для идентификации и аутентификации пользователя.
- Название формы — идентификатор формы, например `nom_list`.
- Название типа — тип данных, например `orders`.

### Пример запроса

```json
{
  "token": "example_token_value",
  "form_name": "nom_list",
  "type": "orders"
}
```

### Ожидаемый ответ от API

_API_ возвращает _JSON_-структуру, которая содержит:

- Список полей табличной части.
- Заголовок (_header_).
- Права доступа к каждому полю (просмотр, редактирование).

### Пример структуры ответа

```json
{
  "fields": [
    {
      "field_name": "product",
      "view": true,
      "edit": true
    },
    {
      "field_name": "quantity",
      "view": true,
      "edit": true
    },
    {
      "field_name": "price",
      "view": true,
      "edit": false
    }
  ]
}
```

### Пояснения:

- header - заголовок полей, с правами доступа к ним.
- fields - список полей табличной части с правами на просмотр и редактирование.


### Дополнительно:

Получение прав:

BUILD `Бекенд (наш) <-> Бекенд (модуль авторизации)`

Наш бекенд посредством взаимодействия через API 
с вашем "модулем авторизации и распределения прав" получает набор прав, 
который мы добавляем в наш список выдачи на фронтенде.

Безопасная авторизация:

BUILD `Фронтенд <-> Бекенд (наш) <-> Бекенд (модуль авторизации)`
DEV `Фронтенд <-> Бекенд (модуль авторизации)`

Фронтенд -> Логин пароль -> Бекенд (модуль авторизации) -> Токен -> Фронтенд

по токену определить:

меню:
+ набор прав для видимого меню который можно отобразить пользователю

таблицы:
+ разрешения CRUD для таблиц и карточки заказов для каждого поля 




